pdSymm(diag(rep(x = 1, times = 3)), nam = c("A","B","C"))
blogdown:::serve_site()
m_lmer <- lmer(nReaction ~ 1 + ( 1 | Subject), data=sleepstudy)
summary(m_lmer)
VarCorr(m_lmer)
getVarCov(m_lmer, type="marginal")
dd <- devfun2(m_lmer, useSc=TRUE)
pp <- attr(dd,"optimum")
sigpars <- pp[grepl("^\\.sig",names(pp))]
all.equal(unname(dd(sigpars)),deviance(refitML(m_lmer)))
all.equal(unname(dd(sigpars)),deviance(refitML(m_lmer)))
sigpars
unname(dd(sigpars)),deviance(refitML(m_lmer))
unname(dd(sigpars))
model.hv_ddm = lme(fixed = nReaction ~ 1,
random = list(Subject = pdDiag(form = ~ factor(G))),
data = sleepstudy,
method = 'REML')
summary(model.hv_ddm)
VarCorr(model.hv_ddm)
View(sleepstudy)
getVarCov(model.hv_ddm, type="marginal", individuals = c(1,3))
getVarCov(model.hv_ddm, type="marginal", individuals = c(1,3))
VarCorr(model.hv_ddm)[2]
2377 + 711.6750
3088.7 - 711.6750
blogdown:::serve_site()
model.hv_w = lme(fixed = Reaction ~ 1,
random = list(Subject = pdSymm(form = ~ 1)),
weights = varIdent(form = ~ 1 | Days),
data = sleepstudy,
method = 'REML')
summary(model.hv_w)
VarCorr(model.hv_w)
getVarCov(model.hv_w, type="marginal", individuals = c(1,3))
model.hv_w = lme(fixed = nReaction ~ 1,
random = list(Subject = pdSymm(form = ~ 1)),
weights = varIdent(form = ~ 1 | Days),
data = sleepstudy,
method = 'REML')
summary(model.hv_w)
model.hv_w = lme(fixed = nReaction ~ 1,
random = list(Subject = pdDiag(form = ~ factor(G))),
weights = varIdent(form = ~ 1 | Days),
data = sleepstudy,
method = 'REML')
summary(model.hv_w)
VarCorr(model.hv_w)
getVarCov(model.hv_w, type="marginal", individuals = c(1,3))
wss.v <- function(model) {
res.std = summary(model)$sigma #to re-scale the values
wts = coef(model$modelStruct$varStruct, unconstrained=FALSE)
res.v.g = (res.std*wts)^2
res.v = data.frame(res.v.g)
colnames(res.v) = "wss"
return(res.v)
}
wss.v(model.hv_w)
kable(wss.v(model.hv_w))
blogdown:::serve_site()
kable(cbind(1:9, wss.v(model.hv_w)))
kable(cbind(Days=1:9, wss.v(model.hv_w)))
blogdown:::new_post_addin()
knitr::kable(head(d))
set.seed(0)
d <- data.frame(x=(rnorm(n = 2000)),
y=rnorm(n=2000),
rcl=factor(sample(1:6, 2000, replace=TRUE)))
knitr::kable(head(d))
ggplot2::ggplot(data=d, aes(x=x, y=y, col=rcl)) +
geom_point()
library(ggplot2)
ggplot2::ggplot(data=d, aes(x=x, y=y, col=rcl)) +
geom_point()
rp <- data.frame(x.c=abs(rnorm(1:6, sd=4)),
y.c=abs(rnorm(6, sd=4)),
rcl=factor(sample(1:6, replace=FALSE)))
ggplot(data=rp, aes(x=x.c, y=y.c, col=rcl)) +
geom_point()
library(dplyr)
dc <- d %>%
left_join(rp, by="rcl") %>%
mutate(x.n=x+(x.c),
y.n=y+(y.c)) %>%
dplyr::select(rcl, x.n, y.n)
ggplot(data=dc, aes(x=x.n, y=y.n, col=rcl)) +
geom_point()
ggplot(data=dc, aes(x=x.n, y=y.n)) +
geom_point(shape=21) +
labs(title="??") +
theme(plot.title = element_text(hjust = 0.5))
library(grid)
image <- jpeg::readJPEG("Henry_Meynell_Rheam_-_Sleeping_Beauty copy.jpg")
ggplot(data=dc, aes(x=x.n, y=y.n)) +
labs(title="??") +
theme(plot.title = element_text(hjust = 0.5)) +
annotation_custom(rasterGrob(image, width = unit(1,"npc"), height = unit(1,"npc")), -Inf, Inf, -Inf, Inf) +
geom_point(shape=21, size=2, col="white") +
coord_fixed()
ggplot(data=dc, aes(x=x.n, y=y.n)) +
labs(title="??") +
theme(plot.title = element_text(hjust = 0.5)) +
annotation_custom(rasterGrob(image, width = unit(1,"npc"), height = unit(1,"npc")), -Inf, Inf, -Inf, Inf) +
geom_point(shape=21, size=2, col=NULL, fill="white", alpha=0.2) +
coord_fixed()
ggplot(data=dc, aes(x=x.n, y=y.n)) +
labs(title="??") +
theme(plot.title = element_text(hjust = 0.5)) +
annotation_custom(rasterGrob(image, width = unit(1,"npc"), height = unit(1,"npc")), -Inf, Inf, -Inf, Inf) +
geom_point(shape=21, size=2, fill="white", alpha=0.2) +
coord_fixed()
ggplot(data=dc, aes(x=x.n, y=y.n)) +
labs(title="??") +
theme(plot.title = element_text(hjust = 0.5)) +
annotation_custom(rasterGrob(image, width = unit(1,"npc"), height = unit(1,"npc")), -Inf, Inf, -Inf, Inf) +
geom_point(shape=21, size=5, fill="white", alpha=0.2) +
coord_fixed()
ggplot(data=dc, aes(x=x.n, y=y.n)) +
labs(title="??") +
theme(plot.title = element_text(hjust = 0.5)) +
annotation_custom(rasterGrob(image, width = unit(1,"npc"), height = unit(1,"npc")), -Inf, Inf, -Inf, Inf) +
geom_point(shape=21, size=5, col=NA, fill="white", alpha=0.2) +
coord_fixed()
ggplot(data=dc, aes(x=x.n, y=y.n)) +
labs(title="??") +
theme(plot.title = element_text(hjust = 0.5)) +
annotation_custom(rasterGrob(image, width = unit(1,"npc"), height = unit(1,"npc")), -Inf, Inf, -Inf, Inf) +
geom_point(size=5, fill="white", alpha=0.2) +
coord_fixed()
ggplot(data=dc, aes(x=x.n, y=y.n)) +
labs(title="??") +
theme(plot.title = element_text(hjust = 0.5)) +
annotation_custom(rasterGrob(image, width = unit(1,"npc"), height = unit(1,"npc")), -Inf, Inf, -Inf, Inf) +
geom_point(size=5, col="white", alpha=0.2) +
coord_fixed()
ggplot(data=dc, aes(x=x.n, y=y.n)) +
labs(title="??") +
theme(plot.title = element_text(hjust = 0.5)) +
annotation_custom(rasterGrob(image, width = unit(1,"npc"), height = unit(1,"npc")), -Inf, Inf, -Inf, Inf) +
geom_point(size=5, col="grey", alpha=0.1) +
coord_fixed()
image <- jpeg::readJPEG("Henry_Meynell_Rheam_-_Sleeping_Beauty copy.jpg")
ggplot(data=dc, aes(x=x.n, y=y.n)) +
labs(title="??") +
theme(plot.title = element_text(hjust = 0.5)) +
annotation_custom(rasterGrob(image, width = unit(1,"npc"), height = unit(1,"npc")), -Inf, Inf, -Inf, Inf) +
geom_point(size=5, col="white", alpha=0.1) +
coord_fixed()
ggplot(data=dc, aes(x=x.n, y=y.n)) +
labs(title="??") +
theme(plot.title = element_text(hjust = 0.5)) +
annotation_custom(rasterGrob(image, width = unit(1,"npc"), height = unit(1,"npc")), -Inf, Inf, -Inf, Inf) +
geom_point(size=5, col="white", alpha=0.2) +
coord_fixed()
ggplot(data=dc, aes(x=x.n, y=y.n)) +
geom_point(size=5, col="white", alpha=0.2) +
labs(title="??") +
theme(plot.title = element_text(hjust = 0.5))
ggplot2::ggplot(data=d, aes(x=x, y=y, col=rcl)) +
geom_point(shape=3)
ggplot(data=rp, aes(x=x.c, y=y.c, col=rcl)) +
geom_point(shape=3)
ggplot(data=dc, aes(x=x.n, y=y.n, col=rcl)) +
geom_point(shape=3)
ggplot(data=dc, aes(x=x.n, y=y.n)) +
geom_point(shape=3) +
labs(title="??") +
theme(plot.title = element_text(hjust = 0.5))
ggplot(data=dc, aes(x=x.n, y=y.n)) +
labs(title="??") +
theme(plot.title = element_text(hjust = 0.5)) +
annotation_custom(rasterGrob(image, width = unit(1,"npc"), height = unit(1,"npc")), -Inf, Inf, -Inf, Inf) +
geom_point(shape=3) +
coord_fixed()
# Determine number of clusters
dc.b <- dc[,-1]
dc.b
wss <- (nrow(dc.b)-1)*sum(apply(dc.b,2,var))
for (i in 2:10) wss[i] <- sum(kmeans(dc.b,
centers=i)$withinss)
ggplot(data=data.frame(Clusters=as.factor(10:1),
SEE=sort(wss, decreasing = FALSE),
group=1),
aes(x=Clusters, y=SEE, group=group)) +
geom_point() +
geom_line()
fit <- kmeans(dc.b, 3) # 3 cluster solution
# get cluster means
aggregate(dc.b,by=list(fit$cluster),FUN=mean)
# append cluster assignment
cl.d <- data.frame(dc.b, fit$cluster)
knitr::kable(head(cl.d))
knitr::kable(aggregate(dc.b,by=list(fit$cluster),FUN=mean))
ggplot(data=cl.d, aes(x=x.n, y=y.n)) + labs(title="K-means", fill="Cluster") +
theme(plot.title = element_text(hjust = 0.5)) +
annotation_custom(rasterGrob(image, width = unit(1,"npc"), height = unit(1,"npc")), -Inf, Inf, -Inf, Inf) +
geom_point(shape=21, size=2, col="white", alpha=0.5, aes(fill=factor(fit.cluster))) +
coord_fixed()
ggplot(data=cl.d, aes(x=x.n, y=y.n)) +
labs(title="K-means", col="Cluster") +
theme(plot.title = element_text(hjust = 0.5)) +
annotation_custom(rasterGrob(image, width = unit(1,"npc"), height = unit(1,"npc")), -Inf, Inf, -Inf, Inf) +
geom_point(shape=6, size=2, alpha=0.5, aes(fill=factor(fit.cluster))) +
coord_fixed()
ggplot(data=cl.d, aes(x=x.n, y=y.n)) +
labs(title="K-means", col="Cluster") +
theme(plot.title = element_text(hjust = 0.5)) +
annotation_custom(rasterGrob(image, width = unit(1,"npc"), height = unit(1,"npc")), -Inf, Inf, -Inf, Inf) +
geom_point(shape=6) +
coord_fixed()
ggplot(data=cl.d, aes(x=x.n, y=y.n, col=fit.cluster)) +
labs(title="K-means", col="Cluster") +
theme(plot.title = element_text(hjust = 0.5)) +
annotation_custom(rasterGrob(image, width = unit(1,"npc"), height = unit(1,"npc")), -Inf, Inf, -Inf, Inf) +
geom_point(shape=3) +
coord_fixed()
ggplot(data=cl.d, aes(x=x.n, y=y.n, col=as.factor(fit.cluster))) +
labs(title="K-means", col="Cluster") +
theme(plot.title = element_text(hjust = 0.5)) +
annotation_custom(rasterGrob(image, width = unit(1,"npc"), height = unit(1,"npc")), -Inf, Inf, -Inf, Inf) +
geom_point(shape=3) +
coord_fixed()
library(fpc)
library(cluster)
pamk.best <- pamk(dc.b)
med <- pamk.best$pamobject$medoids
cl.pam <- data.frame(dc.b, pam.cluster=pamk.best$pamobject$clustering)
knitr::kable(head(cl.pam))
install.packages("fpc")
install.packages("cluster")
library(fpc)
library(cluster)
pamk.best <- pamk(dc.b)
med <- pamk.best$pamobject$medoids
cl.pam <- data.frame(dc.b, pam.cluster=pamk.best$pamobject$clustering)
knitr::kable(head(cl.pam))
dc.b
ggplot(data=cl.pam, aes(x=x.n, y=y.n)) +
labs(title="Partitioning Around Medoids",
fill="Cluster",
caption="X = Medoid") +
theme(plot.title = element_text(hjust = 0.5)) +
annotation_custom(rasterGrob(image, width = unit(1,"npc"), height = unit(1,"npc")), -Inf, Inf, -Inf, Inf) +
geom_point(shape=21, size=2, col="white", alpha=0.5, aes(fill=factor(pam.cluster))) +
coord_fixed() +
geom_point(data=as.data.frame(med), aes(x=x.n, y=y.n), shape="X", col="red", size=4) +
theme(plot.caption = element_text(hjust = 0.5, colour = "red"))
ggplot(data=cl.pam, aes(x=x.n, y=y.n)) +
labs(title="Partitioning Around Medoids",
fill="Cluster",
caption="X = Medoid") +
theme(plot.title = element_text(hjust = 0.5)) +
annotation_custom(rasterGrob(image, width = unit(1,"npc"), height = unit(1,"npc")), -Inf, Inf, -Inf, Inf) +
geom_point(shape=3, aes(col=c(pam.cluster))) +
coord_fixed() +
geom_point(data=as.data.frame(med),
aes(x=x.n, y=y.n), shape="X", col="red", size=4) +
theme(plot.caption = element_text(hjust = 0.5, colour = "red"))
ggplot(data=cl.pam, aes(x=x.n, y=y.n)) +
labs(title="Partitioning Around Medoids",
fill="Cluster",
caption="X = Medoid") +
theme(plot.title = element_text(hjust = 0.5)) +
annotation_custom(rasterGrob(image, width = unit(1,"npc"), height = unit(1,"npc")), -Inf, Inf, -Inf, Inf) +
geom_point(shape=3, aes(col=as.factor(pam.cluster))) +
coord_fixed() +
geom_point(data=as.data.frame(med),
aes(x=x.n, y=y.n), shape="X", col="red", size=4) +
theme(plot.caption = element_text(hjust = 0.5, colour = "red"))
ggplot(data=cl.pam, aes(x=x.n, y=y.n)) +
labs(title="Partitioning Around Medoids",
col="Cluster",
caption="X = Medoid") +
theme(plot.title = element_text(hjust = 0.5)) +
annotation_custom(rasterGrob(image, width = unit(1,"npc"), height = unit(1,"npc")), -Inf, Inf, -Inf, Inf) +
geom_point(shape=3, aes(col=as.factor(pam.cluster))) +
coord_fixed() +
geom_point(data=as.data.frame(med),
aes(x=x.n, y=y.n), shape="X", col="red", size=4) +
theme(plot.caption = element_text(hjust = 0.5, colour = "red"))
library(MASS)
# scale data by sd
sd <- cbind(x.n=sd(dc.b$x.n), y.n=sd(dc.b$y.n))
sc.d <- dc.b/sd
#estimate bandwidth
# bandwidth.nrd(sc.d$x.n)
# bandwidth.nrd(sc.d$y.n)
#calculate density
z <- kde2d(sc.d$x.n, sc.d$y.n)
pic <- ggplot(sc.d, aes(x=x.n, y=y.n)) +
annotation_custom(rasterGrob(image, width = unit(1,"npc"), height = unit(1,"npc")), -Inf, Inf, -Inf, Inf) +
stat_density2d(aes(fill=..level..), geom="polygon", alpha=0.5, h=c(0.3, 0.3)) +
stat_density2d(aes(col=..level..), h=c(0.3, 0.3)) +
scale_fill_gradient2(low="skyblue2", high="firebrick1", midpoint=mean(range(z$z))) +
scale_color_continuous(low="skyblue2", high="firebrick1") +
coord_fixed() +
labs(y="") +
guides(color=FALSE)
points <- ggplot() +
geom_point(data=sc.d, aes(x=x.n, y=y.n),
shape=21, size=2, col="black", fill="gray", alpha=0.8, size=2) +
stat_density2d(data=sc.d, aes(x=x.n, y=y.n, fill=..level..), geom="polygon", alpha=0.5, h=c(0.3, 0.3)) +
stat_density2d(data=sc.d, aes(x=x.n, y=y.n, col=..level..), h=c(0.3, 0.3)) +
scale_fill_gradient2(low="skyblue2", high="firebrick1", midpoint=mean(range(z$z))) +
scale_color_continuous(low="skyblue2", high="firebrick1") +
coord_fixed() +
labs(y="") +
guides(color=FALSE)
library(ggpubr)
twop1 <- ggarrange(pic, points, ncol = 2, common.legend = TRUE, legend = "right")
twop1 <- annotate_figure(twop1,
top = text_grob("Multivariate kernel density estimation"),
bottom = text_grob("Scaling: SD \n Bandwidth: 0.3",
hjust = 1),
left = text_grob("y.n", rot = 90))
# ggsave(plot = twop1, filename = "twop1-2.pdf")
twop1
bandwidth.nrd(sc.d$x.n)
bandwidth.nrd(sc.d$y.n)
set.seed(88)
library(LPCM)
cl.ms <- ms(as.matrix(sc.d), scaled=0, h=0.3)
plot(cl.ms)
cl.ms$h
cl.ms$cluster.center
install.packages("LPCM")
library(LPCM)
set.seed(88)
cl.ms <- ms(as.matrix(sc.d), scaled=0, h=0.3)
plot(cl.ms)
cl.ms$h
cl.ms$cluster.center
knitr::kable(cl.ms$cluster.center)
x <- cbind(cl.ms$cluster.center[,1])
rownames(x) <- NULL
y <- cbind(cl.ms$cluster.center[,2])
rownames(y) <- NULL
cc <- cbind(1:nrow(x))
coo <- as.data.frame(cbind(x,y,cc))
colnames(coo) <- c("x.n", "y.n", "cc")
# cc <- data.frame(x=c(0.79, 2.41, 1.98, 1.60, 2.08, 2.08, 3.20),
#                                  y=c(0.62, 0.76, 0.04, 3.02, 1.45, 0.65, 4.18),
#                                  cc=as.factor(c(1,2,3,4,5,6,7))) #I hardcoded this because it wouldnt knit it otherwise...
modes <- points + geom_point(aes(x=x.n,
y=y.n,
shape=as.factor(cc)),
data=coo,
fill="blue", size=4) +
labs(col="Shift Cluster") +
scale_shape_manual(values = c(21,22,23,24)) +
labs(shape="Cluster Center")
modes
sc.d.1 <- subset(sc.d, shift.cluster==1)
sc.d.2 <- subset(sc.d, shift.cluster==2)
sc.d.3 <- subset(sc.d, shift.cluster==3)
sc.d.4 <- subset(sc.d, shift.cluster==4)
# sc.d.5 <- subset(sc.d, shift.cluster==5)
# sc.d.6 <- subset(sc.d, shift.cluster==6)
# sc.d.7 <- subset(sc.d, shift.cluster==7)
library(ggalt)
cl <- ggplot(data=sc.d, aes(x=x.n, y=y.n)) +
labs(y="") +
annotation_custom(rasterGrob(image, width = unit(1,"npc"),
height = unit(1,"npc")), -Inf, Inf,
-Inf, Inf) +
geom_point(size=4,
aes(shape=factor(shift.cluster)),
alpha=0.5) +
coord_fixed() +
scale_shape_manual(values = c(21,22,23,24
)) +
labs(shape="Cluster Center") +
geom_point(aes(x=x.n, y=y.n, shape=as.factor(cc)), fill="blue", data=coo, size=4) +
geom_encircle(data = sc.d.1, col="red", linetype="twodash") +
geom_encircle(data = sc.d.2, col="red", linetype="longdash") +
geom_encircle(data = sc.d.3, col="red", linetype="dotdash") +
geom_encircle(data = sc.d.4, col="red", linetype="solid")
# +
# geom_encircle(data = sc.d.5, col="red", linetype="F1") +
# geom_encircle(data = sc.d.6, col="red", linetype="dotted") +
# geom_encircle(data = sc.d.7, col="red", linetype="dashed")
twop2 <- ggarrange(cl, modes, ncol = 2, common.legend = TRUE, legend = "right")
twop2 <- annotate_figure(twop2,
top = text_grob("Mean Shift Clustering"),
bottom = text_grob("Scaling: SD \n Bandwidth: 0.3",
hjust = 1),
left = text_grob("y.n", rot = 90))
# ggsave(plot = twop2, filename ="twop2.pdf", width = 10)
twop2
sc.d.1 <- subset(sc.d, shift.cluster==1)
sc.d.2 <- subset(sc.d, shift.cluster==2)
sc.d.3 <- subset(sc.d, shift.cluster==3)
sc.d.4 <- subset(sc.d, shift.cluster==4)
sc.d
sc.d$shift.cluster <- cl.ms$cluster.label
sc.d.1 <- subset(sc.d, shift.cluster==1)
sc.d.2 <- subset(sc.d, shift.cluster==2)
sc.d.3 <- subset(sc.d, shift.cluster==3)
sc.d.4 <- subset(sc.d, shift.cluster==4)
library(ggalt)
cl <- ggplot(data=sc.d, aes(x=x.n, y=y.n)) +
labs(y="") +
annotation_custom(rasterGrob(image, width = unit(1,"npc"),
height = unit(1,"npc")), -Inf, Inf,
-Inf, Inf) +
geom_point(size=4,
aes(shape=factor(shift.cluster)),
alpha=0.5) +
coord_fixed() +
scale_shape_manual(values = c(21,22,23,24
)) +
labs(shape="Cluster Center") +
geom_point(aes(x=x.n, y=y.n, shape=as.factor(cc)), fill="blue", data=coo, size=4) +
geom_encircle(data = sc.d.1, col="red", linetype="twodash") +
geom_encircle(data = sc.d.2, col="red", linetype="longdash") +
geom_encircle(data = sc.d.3, col="red", linetype="dotdash") +
geom_encircle(data = sc.d.4, col="red", linetype="solid")
install.packages("ggalt")
library(ggalt)
cl <- ggplot(data=sc.d, aes(x=x.n, y=y.n)) +
labs(y="") +
annotation_custom(rasterGrob(image, width = unit(1,"npc"),
height = unit(1,"npc")), -Inf, Inf,
-Inf, Inf) +
geom_point(size=4,
aes(shape=factor(shift.cluster)),
alpha=0.5) +
coord_fixed() +
scale_shape_manual(values = c(21,22,23,24
)) +
labs(shape="Cluster Center") +
geom_point(aes(x=x.n, y=y.n, shape=as.factor(cc)), fill="blue", data=coo, size=4) +
geom_encircle(data = sc.d.1, col="red", linetype="twodash") +
geom_encircle(data = sc.d.2, col="red", linetype="longdash") +
geom_encircle(data = sc.d.3, col="red", linetype="dotdash") +
geom_encircle(data = sc.d.4, col="red", linetype="solid")
# +
# geom_encircle(data = sc.d.5, col="red", linetype="F1") +
# geom_encircle(data = sc.d.6, col="red", linetype="dotted") +
# geom_encircle(data = sc.d.7, col="red", linetype="dashed")
twop2 <- ggarrange(cl, modes, ncol = 2, common.legend = TRUE, legend = "right")
twop2 <- annotate_figure(twop2,
top = text_grob("Mean Shift Clustering"),
bottom = text_grob("Scaling: SD \n Bandwidth: 0.3",
hjust = 1),
left = text_grob("y.n", rot = 90))
# ggsave(plot = twop2, filename ="twop2.pdf", width = 10)
twop2
cl
cl <- ggplot(data=sc.d, aes(x=x.n, y=y.n)) +
labs(y="") +
annotation_custom(rasterGrob(image, width = unit(1,"npc"),
height = unit(1,"npc")), -Inf, Inf,
-Inf, Inf) +
geom_point(shape=3)) +
coord_fixed() +
labs(shape="Cluster Center") +
geom_point(aes(x=x.n, y=y.n, shape=as.factor(cc)),
fill="blue", data=coo, size=4) +
geom_encircle(data = sc.d.1, col="red", linetype="twodash") +
geom_encircle(data = sc.d.2, col="red", linetype="longdash") +
geom_encircle(data = sc.d.3, col="red", linetype="dotdash") +
geom_encircle(data = sc.d.4, col="red", linetype="solid")
cl
ggplot(data=sc.d, aes(x=x.n, y=y.n)) +
labs(y="") +
annotation_custom(rasterGrob(image, width = unit(1,"npc"),
height = unit(1,"npc")), -Inf, Inf,
-Inf, Inf) +
geom_point(shape=3)) +
coord_fixed() +
labs(shape="Cluster Center") +
geom_point(aes(x=x.n, y=y.n, shape=as.factor(cc)),
fill="blue", data=coo, size=4)
ggplot(data=sc.d, aes(x=x.n, y=y.n)) +
labs(y="") +
annotation_custom(rasterGrob(image, width = unit(1,"npc"),
height = unit(1,"npc")), -Inf, Inf,
-Inf, Inf)
ggplot(data=sc.d, aes(x=x.n, y=y.n)) +
labs(y="") +
annotation_custom(rasterGrob(image, width = unit(1,"npc"),
height = unit(1,"npc")), -Inf, Inf,
-Inf, Inf) +
geom_point(shape=3))
ggplot(data=sc.d, aes(x=x.n, y=y.n)) +
labs(y="") +
annotation_custom(rasterGrob(image, width = unit(1,"npc"),
height = unit(1,"npc")), -Inf, Inf,
-Inf, Inf) +
geom_point(shape=3)
cl <- ggplot(data=sc.d, aes(x=x.n, y=y.n)) +
labs(y="") +
annotation_custom(rasterGrob(image, width = unit(1,"npc"),
height = unit(1,"npc")), -Inf, Inf,
-Inf, Inf) +
geom_point(shape=3) +
coord_fixed() +
labs(shape="Cluster Center") +
geom_point(aes(x=x.n, y=y.n, shape=as.factor(cc)),
fill="blue", data=coo, size=4) +
geom_encircle(data = sc.d.1, col="red", linetype="twodash") +
geom_encircle(data = sc.d.2, col="red", linetype="longdash") +
geom_encircle(data = sc.d.3, col="red", linetype="dotdash") +
geom_encircle(data = sc.d.4, col="red", linetype="solid")
cl
annotate_figure(cl,
top = text_grob("Mean Shift Clustering"),
bottom = text_grob("Scaling: SD \n Bandwidth: 0.3",
hjust = 1),
left = text_grob("y.n", rot = 90))
blogdown:::serve_site()
