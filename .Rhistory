knitr::kable(head(bs_data_p))
ggplot(data=(gp_data),
aes(x=m.Reaction, y=Intercept,
fill=Subject)) +
facet_grid(~Method) +
geom_errorbar(aes(x=m.Reaction,
ymin=Intercept-St.er.int,
ymax=Intercept+St.er.int,
col=er.st.int),
position=position_dodge(2)) +
geom_jitter(aes(size=N), shape=21) +
scale_radius() +
scale_fill_manual(values=fill1) +
scale_color_manual(values=c("firebrick1", "black", "darkorange")) +
guides(fill = "none") +
coord_cartesian(ylim=c(150, 350)) +
theme_bw()
library(RColorBrewer)
set.seed(7)
n <- length(unique(sleepstudy$Subject))
fill <- grDevices::colors()
fill1 <- sample(fill, n)
library(ggplot2)
ggplot(data=(gp_data),
aes(x=m.Reaction, y=Intercept,
fill=Subject)) +
facet_grid(~Method) +
geom_errorbar(aes(x=m.Reaction,
ymin=Intercept-St.er.int,
ymax=Intercept+St.er.int,
col=er.st.int),
position=position_dodge(2)) +
geom_jitter(aes(size=N), shape=21) +
scale_radius() +
scale_fill_manual(values=fill1) +
scale_color_manual(values=c("firebrick1", "black", "darkorange")) +
guides(fill = "none") +
coord_cartesian(ylim=c(150, 350)) +
theme_bw()
ggplot(data=(gp_data),
aes(x=m.Reaction, y=Intercept,
fill=Subject)) +
facet_grid(~Method) +
geom_errorbar(aes(x=m.Reaction,
ymin=Intercept-St.er.int,
ymax=Intercept+St.er.int,
col=er.st.int),
position=position_dodge(2))
ggplot(data=(bs_data_p),
aes(x=m.Reaction, y=Intercept,
fill=Subject)) +
facet_grid(~Method) +
geom_errorbar(aes(x=m.Reaction,
ymin=Intercept-St.er.int,
ymax=Intercept+St.er.int,
col=er.st.int),
position=position_dodge(2)) +
geom_jitter(aes(size=N), shape=21) +
scale_radius() +
scale_fill_manual(values=fill1) +
scale_color_manual(values=c("firebrick1", "black", "darkorange")) +
guides(fill = "none") +
coord_cartesian(ylim=c(150, 350)) +
theme_bw()
ggplot(data=(bs_data_p),
aes(x=Reaction, y=Intercept,
fill=Subject)) +
facet_grid(~Method) +
geom_errorbar(aes(x=Reaction,
ymin=Intercept-St.er.int,
ymax=Intercept+St.er.int,
col=er.st.int),
position=position_dodge(2)) +
geom_jitter(aes(size=N), shape=21) +
scale_radius() +
scale_fill_manual(values=fill1) +
scale_color_manual(values=c("firebrick1", "black", "darkorange")) +
guides(fill = "none") +
coord_cartesian(ylim=c(150, 350)) +
theme_bw()
bs_data_p <- bs_data %>%
left_join(gp_data, by="Subject") %>%
left_join(m.er.int, by="Method") %>%
mutate(er.st.int=ifelse(St.er.int>1.9*m.er.int, "above 2 std. er",
ifelse(St.er.int>m.er.int & St.er.int<1.9*m.er.int, "within 1 std. err",
ifelse(St.er.int<m.er.int & St.er.int>-1.9*m.er.int, "within 1 std. err",
ifelse(St.er.int<-1.9*m.er.int, "below 2 std. er",))))) %>%
mutate(er.st.int=factor(er.st.int, levels = c("above 2 std. er", "within 1 std. err", "below 2 std. er")))
knitr::kable(head(bs_data_p))
knitr::kable(head(bs_data_p))
ggplot(data=(bs_data_p),
aes(x=Reaction, y=Intercept,
fill=Subject)) +
facet_grid(~Method) +
geom_errorbar(aes(x=Reaction,
ymin=Intercept-St.er.int,
ymax=Intercept+St.er.int,
col=er.st.int),
position=position_dodge(2)) +
geom_jitter(aes(size=N), shape=21) +
scale_radius() +
scale_fill_manual(values=fill1) +
scale_color_manual(values=c("firebrick1", "black", "darkorange")) +
guides(fill = "none") +
coord_cartesian(ylim=c(150, 350)) +
theme_bw()
bs_data_p <- bs_data %>%
left_join(gp_data, by="Subject") %>%
left_join(m.er.int, by="Method") %>%
mutate(er.st.int=ifelse(St.er.int>1.9*m.er.int, "above 2 std. er",
ifelse(St.er.int>m.er.int & St.er.int<1.9*m.er.int, "within 1 std. err",
ifelse(St.er.int<m.er.int & St.er.int>-1.9*m.er.int, "within 1 std. err",
ifelse(St.er.int<-1.9*m.er.int, "below 2 std. er",))))) %>%
mutate(er.st.int=factor(er.st.int, levels = c("above 2 std. er", "within 1 std. err", "below 2 std. er"))) %>%
mutate(Method=factor(Method, levels = c("n-slr", "i-slr", "mm")))
ggplot(data=(bs_data_p),
aes(x=Reaction, y=Intercept,
fill=Subject)) +
facet_grid(~Method) +
geom_errorbar(aes(x=Reaction,
ymin=Intercept-St.er.int,
ymax=Intercept+St.er.int,
col=er.st.int),
position=position_dodge(2)) +
geom_jitter(aes(size=N), shape=21) +
scale_radius() +
scale_fill_manual(values=fill1) +
scale_color_manual(values=c("firebrick1", "black", "darkorange")) +
guides(fill = "none") +
coord_cartesian(ylim=c(150, 350)) +
theme_bw()
ggplot(bs_data_p,
aes(x=N, y=Intercept,
fill=Subject)) +
geom_errorbar(position=position_dodge(5),
aes(ymin=Intercept-St.er.int,
ymax=Intercept+St.er.int,
col=er.st.int, group=Subject)) +
geom_point(size=3, position=position_dodge(5), shape=23) +
guides(fill = "none") +
scale_fill_manual(values = fill1) +
scale_color_manual(values=c("firebrick1", "black", "darkorange")) +
facet_wrap(~Method) +
theme_bw()
ggplot(bs_data_p,
aes(x=N, y=Intercept,
fill=Subject)) +
geom_errorbar(position=position_dodge(5),
aes(ymin=Intercept-St.er.int,
ymax=Intercept+St.er.int,
col=er.st.int, group=Subject)) +
geom_point(size=3, position=position_dodge(5), shape=23) +
guides(fill = "none") +
scale_fill_manual(values = fill1) +
scale_color_manual(values=c("firebrick1", "black", "darkorange")) +
scale_x_continuous(breaks = c(5:10)) +
facet_wrap(~Method) +
theme_bw()
blogdown:::serve_site()
# install.packages(c("lme4", "dplyr", "knitr", "ggplot2"))
library(lme4) #initialise the libraries containing the functions that we need
library(dplyr)
data("sleepstudy") # initialise the dataset
set.seed(7) #setting the seed to we sample the same row numbers
missing <- sample_n(sleepstudy, 18, weight = Reaction) %>%
arrange(Subject)
sleepstudy <- sleepstudy %>%
anti_join(missing, by = c("Reaction", "Days", "Subject"))
knitr::kable(head(sleepstudy))
lm_nslr <-lm(Reaction ~ Days + Subject - 1, data=sleepstudy)
coef <- summary(lm_nslr)$coefficients
coef.lm_nslr <- rbind(data.frame(Subject=gsub(pattern="Subject",
replacement="",
x=rownames(coef[-1,])),
Intercept=coef[-1,1],
St.er.int=coef[-1,2],
Method="n-slr"))
rownames(coef.lm_nslr) <- NULL
knitr::kable(head(coef.lm_nslr))
coef.lm_islr <- data.frame()
ids <- unique(sleepstudy$Subject)
for (i in 1:length(ids))
{
d.s = subset(sleepstudy, Subject==ids[i])
if (is.nan(mean(d.s$Days, na.rm=T)))
{
coef.lm_islr = rbind(coef.lm_islr, data.frame(Subject=(ids[i]),
Intercept=NA, St.er.int=NA, Method="i-slr"))
}
else
{
lm_islr = lm(Reaction ~ Days, data=d.s)
coef = summary(lm_islr)$coefficients
coef.lm_islr = rbind(coef.lm_islr, data.frame(Subject=(ids[i]),
Intercept=coef[1,1], St.er.int=coef[1,2], Method="i-slr"))
}
}
knitr::kable(head(coef.lm_islr))
lm_mm <- lmer(Reaction ~ Days + (1|Subject), data=sleepstudy)
coef <- coef(lm_mm)$Subject$'(Intercept)'
err <- ranef(lm_mm)$Subject$'(Intercept)'
coef.mm <- rbind(data.frame(Subject=rownames(coef(lm_mm)$Subject),
Intercept=coef, St.er.int=err, Method="mm"))
knitr::kable(head(coef.mm))
all_coef <- rbind(coef.lm_nslr, coef.lm_islr, coef.mm)
bs_data <- sleepstudy %>%
filter(Days==0) %>%
left_join(all_coef, by="Subject")
```{r}
gp_data <- sleepstudy %>%
group_by(Subject) %>%
summarise(N=n())
```
bs_data <- sleepstudy %>%
filter(Days==0) %>%
left_join(all_coef, by="Subject")
gp_data <- sleepstudy %>%
group_by(Subject) %>%
summarise(N=n())
```{r}
m.er.int <- all_coef %>%
group_by(Method) %>%
summarise(m.er.int=mean(St.er.int))
```
m.er.int <- all_coef %>%
group_by(Method) %>%
summarise(m.er.int=mean(St.er.int))
bs_data_p <- bs_data %>%
left_join(gp_data, by="Subject") %>%
left_join(m.er.int, by="Method") %>%
mutate(er.st.int=ifelse(St.er.int>1.9*m.er.int, "above 2 std. er",
ifelse(St.er.int>m.er.int & St.er.int<1.9*m.er.int, "within 1 std. err",
ifelse(St.er.int<m.er.int & St.er.int>-1.9*m.er.int, "within 1 std. err",
ifelse(St.er.int<-1.9*m.er.int, "below 2 std. er",))))) %>%
mutate(er.st.int=factor(er.st.int, levels = c("above 2 std. er", "within 1 std. err", "below 2 std. er"))) %>%
mutate(Method=factor(Method, levels = c("n-slr", "i-slr", "mm")))
knitr::kable(head(bs_data_p))
library(RColorBrewer)
set.seed(7)
n <- length(unique(sleepstudy$Subject))
fill <- grDevices::colors()
fill1 <- sample(fill, n)
ggplot(data=(bs_data_p),
aes(x=Reaction, y=Intercept,
fill=Subject)) +
facet_grid(~Method) +
geom_errorbar(aes(x=Reaction,
ymin=Intercept-St.er.int,
ymax=Intercept+St.er.int,
col=er.st.int),
position=position_dodge(2)) +
geom_jitter(aes(size=N), shape=21) +
scale_radius() +
scale_fill_manual(values=fill1) +
scale_color_manual(values=c("firebrick1", "black", "darkorange")) +
guides(fill = "none") +
coord_cartesian(ylim=c(150, 350)) +
theme_bw()
library(ggplot2)
ggplot(data=(bs_data_p),
aes(x=Reaction, y=Intercept,
fill=Subject)) +
facet_grid(~Method) +
geom_errorbar(aes(x=Reaction,
ymin=Intercept-St.er.int,
ymax=Intercept+St.er.int,
col=er.st.int),
position=position_dodge(2)) +
geom_jitter(aes(size=N), shape=21) +
scale_radius() +
scale_fill_manual(values=fill1) +
scale_color_manual(values=c("firebrick1", "black", "darkorange")) +
guides(fill = "none") +
coord_cartesian(ylim=c(150, 350)) +
theme_bw()
tiff("test.tiff", units="px", width=481, height=350, res=300)
ggplot(data=(bs_data_p),
aes(x=Reaction, y=Intercept,
fill=Subject)) +
facet_grid(~Method) +
geom_errorbar(aes(x=Reaction,
ymin=Intercept-St.er.int,
ymax=Intercept+St.er.int,
col=er.st.int),
position=position_dodge(2)) +
geom_jitter(aes(size=N), shape=21) +
scale_radius() +
scale_fill_manual(values=fill1) +
scale_color_manual(values=c("firebrick1", "black", "darkorange")) +
guides(fill = "none") +
coord_cartesian(ylim=c(150, 350)) +
theme_bw()
dev.off()
tiff("test.tiff", units="px", width=481, height=350, dpi=300)
ggplot(data=(bs_data_p),
aes(x=Reaction, y=Intercept,
fill=Subject)) +
facet_grid(~Method) +
geom_errorbar(aes(x=Reaction,
ymin=Intercept-St.er.int,
ymax=Intercept+St.er.int,
col=er.st.int),
position=position_dodge(2)) +
geom_jitter(aes(size=N), shape=21) +
scale_radius() +
scale_fill_manual(values=fill1) +
scale_color_manual(values=c("firebrick1", "black", "darkorange")) +
guides(fill = "none") +
coord_cartesian(ylim=c(150, 350)) +
theme_bw()
dev.off()
p <- ggplot(data=(bs_data_p),
aes(x=Reaction, y=Intercept,
fill=Subject)) +
facet_grid(~Method) +
geom_errorbar(aes(x=Reaction,
ymin=Intercept-St.er.int,
ymax=Intercept+St.er.int,
col=er.st.int),
position=position_dodge(2)) +
geom_jitter(aes(size=N), shape=21) +
scale_radius() +
scale_fill_manual(values=fill1) +
scale_color_manual(values=c("firebrick1", "black", "darkorange")) +
guides(fill = "none") +
coord_cartesian(ylim=c(150, 350)) +
theme_bw()
ggsave(p, "test.jpg", dpi=300)
p
ggsave(filename = "test.jpg", plot = p, dpi = 300)
p <- ggplot(bs_data_p,
aes(x=N, y=Intercept,
fill=Subject)) +
geom_errorbar(position=position_dodge(5),
aes(ymin=Intercept-St.er.int,
ymax=Intercept+St.er.int,
col=er.st.int, group=Subject)) +
geom_point(size=3, position=position_dodge(5), shape=23) +
guides(fill = "none") +
scale_fill_manual(values = fill1) +
scale_color_manual(values=c("firebrick1", "black", "darkorange")) +
scale_x_continuous(breaks = c(5:10)) +
facet_wrap(~Method) +
theme_bw()
ggsave(p, "test2.jpg", dpi=300)
ggsave(filename = "test2.jpg", plot = p, dpi = 300)
p <- ggplot(bs_data_p,
aes(x=N, y=Intercept,
fill=Subject)) +
geom_errorbar(position=position_dodge(5),
aes(ymin=Intercept-St.er.int,
ymax=Intercept+St.er.int,
col=er.st.int, group=Subject)) +
geom_point(size=3, position=position_dodge(5), shape=21) +
guides(fill = "none") +
scale_fill_manual(values = fill1) +
scale_color_manual(values=c("firebrick1", "black", "darkorange")) +
scale_x_continuous(breaks = c(5:10)) +
facet_wrap(~Method) +
theme_bw()
ggsave(filename = "test2.jpg", plot = p, dpi = 300)
bs_data <- sleepstudy %>%
filter(Days==0) %>%
left_join(all_coef, by="Subject")
gp_data <- sleepstudy %>%
group_by(Subject) %>%
summarise(N=n())
m.er.int <- all_coef %>%
group_by(Method) %>%
summarise(m.er.int=mean(St.er.int))
bs_data_p <- bs_data %>%
left_join(gp_data, by="Subject") %>%
left_join(m.er.int, by="Method") %>%
mutate(er.st.int=ifelse(St.er.int>1.9+m.er.int, "above 2 std. er",
ifelse(St.er.int>m.er.int & St.er.int<1.9+m.er.int, "within 1 std. err",
ifelse(St.er.int<m.er.int & St.er.int>-1.9+m.er.int, "within 1 std. err",
ifelse(St.er.int<-1.9+m.er.int, "below 2 std. er",))))) %>%
mutate(er.st.int=factor(er.st.int, levels = c("above 2 std. er", "within 1 std. err", "below 2 std. er"))) %>%
mutate(Method=factor(Method, levels = c("n-slr", "i-slr", "mm")))
knitr::kable(head(bs_data_p))
library(RColorBrewer)
set.seed(7)
n <- length(unique(sleepstudy$Subject))
fill <- grDevices::colors()
fill1 <- sample(fill, n)
ggplot(data=(bs_data_p),
aes(x=Reaction, y=Intercept,
fill=Subject)) +
facet_grid(~Method) +
geom_errorbar(aes(x=Reaction,
ymin=Intercept-St.er.int,
ymax=Intercept+St.er.int,
col=er.st.int),
position=position_dodge(2)) +
geom_jitter(aes(size=N), shape=21) +
scale_radius() +
scale_fill_manual(values=fill1) +
scale_color_manual(values=c("firebrick1", "black", "darkorange")) +
guides(fill = "none") +
coord_cartesian(ylim=c(150, 350)) +
theme_bw()
p <- ggplot(data=(bs_data_p),
aes(x=Reaction, y=Intercept,
fill=Subject)) +
facet_grid(~Method) +
geom_errorbar(aes(x=Reaction,
ymin=Intercept-St.er.int,
ymax=Intercept+St.er.int,
col=er.st.int),
position=position_dodge(2)) +
geom_jitter(aes(size=N), shape=21) +
scale_radius() +
scale_fill_manual(values=fill1) +
scale_color_manual(values=c("firebrick1", "black", "darkorange")) +
guides(fill = "none") +
coord_cartesian(ylim=c(150, 350)) +
theme_bw()
ggsave(filename = "test.jpg", plot = p, dpi=300)
p <- ggplot(bs_data_p,
aes(x=N, y=Intercept,
fill=Subject)) +
geom_errorbar(position=position_dodge(5),
aes(ymin=Intercept-St.er.int,
ymax=Intercept+St.er.int,
col=er.st.int, group=Subject)) +
geom_point(size=3, position=position_dodge(5), shape=21) +
guides(fill = "none") +
scale_fill_manual(values = fill1) +
scale_color_manual(values=c("firebrick1", "black", "darkorange")) +
scale_x_continuous(breaks = c(5:10)) +
facet_wrap(~Method) +
theme_bw()
ggsave(filename = "test2.jpg", plot = p, dpi=300)
View(bs_data_p)
```{r}
lm_nslr
```{r}
lm_nslr$coef
```{r}
lm_nslr$coef[-1]
```{r}
mean(lm_nslr$coef[-1])
```{r}
mean(lm_nslr$coef[-1])
lm_islr
```
```{r}
mean(lm_nslr$coef[-1])
lm_islr
```
```{r}
mean(lm_nslr$coef[-1])
lm_islr
```
lm_islr
coef.lm_islr
coef.lm_islr$Intercept
```{r}
mean(lm_nslr$coef[-1])
mean(coef.lm_islr$Intercept)
```
mean(coef.lm_islr$Intercept)
```{r}
mean(lm_nslr$coef[-1])
mean(coef.lm_islr$Intercept)
(coef.mm$Intercept)
```
```{r}
mean(lm_nslr$coef[-1])
mean(coef.lm_islr$Intercept)
mean(coef.mm$Intercept)
```
```{r}
rbind(mean(lm_nslr$coef[-1])
mean(coef.lm_islr$Intercept)
mean(coef.mm$Intercept))
```
rbind(mean(lm_nslr$coef[-1]),
mean(coef.lm_islr$Intercept),
mean(coef.mm$Intercept))
rbind(`n-slr'=mean(lm_nslr$coef[-1]),
mean(coef.lm_islr$Intercept),
mean(coef.mm$Intercept))
)
)
sdchbsdjhv
csjskjncsajn
rbind(`n-slr`=mean(lm_nslr$coef[-1]),
mean(coef.lm_islr$Intercept),
mean(coef.mm$Intercept))
rbind(`n-slr`=mean(lm_nslr$coef[-1]),
mean(coef.lm_islr$Intercept),
mean(coef.mm$Intercept))
rbind(`n-slr`=mean(lm_nslr$coef[-1]),
mean(`i-sle`=coef.lm_islr$Intercept),
mean(`mm`=coef.mm$Intercept))
rbind(`n-slr`=mean(lm_nslr$coef[-1]),
`i-slr`=mean(coef.lm_islr$Intercept),
`mm`=mean(coef.mm$Intercept))
knitr::kable(rbind(`n-slr`=mean(lm_nslr$coef[-1]),
`i-slr`=mean(coef.lm_islr$Intercept),
`mm`=mean(coef.mm$Intercept)))
blogdown:::serve_site()
ggplot(bs_data_p,
aes(x=N, y=Intercept,
fill=Subject))
ggplot(bs_data_p,
aes(x=N, y=Intercept,
fill=Subject)) +
scale_x_continuous(breaks = c(5:10)) +
facet_wrap(~Method) +
theme_bw()
